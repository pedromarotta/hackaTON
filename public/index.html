<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>TON Onâ€‘Ramp Demo</title>
</head>
<body>
  <h1>TON Onâ€‘Ramp (ARSÂ â†’Â TON)</h1>
  <button id="payBtn">Pay with MercadoÂ Pago</button>

  <script>
    document.getElementById("payBtn")
      .addEventListener("click", async () => {
        console.log("ðŸŸ¡ Button clicked");
        try {
          const res = await fetch('/create-payment', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({
              amount: 1000,           // ARS amount
              description: "TON Purchase"
            })
          });
          const data = await res.json();
          console.log("ðŸŸ¢ Response from backend:", data);
          if (data.url) {
            // Open the Mercado Pago sandbox checkout in a new tab
            window.open(data.url, '_blank');
          } else {
            alert("Failed to generate payment link.");
          }
        } catch (err) {
          console.error("ðŸ”´ Fetch error:", err);
          alert("Request failed.");
        }
      });
  </script>
</body>
</html>
